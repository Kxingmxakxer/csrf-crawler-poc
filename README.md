# CSRF Vulnerability Crawler & Proof of Concept

## Overview

This project explores Cross-Site Request Forgery (CSRF) vulnerabilities through a theoretical approach backed by tooling. It includes research on CSRF protections, a conceptual crawler to detect missing CSRF tokens in web forms, and a Proof of Concept (PoC) HTML page that simulates a CSRF attack.

---

## Table of Contents

- [Introduction to CSRF](#introduction-to-csrf)
- [CSRF Protection Mechanisms](#csrf-protection-mechanisms)
- [Crawler Objectives](#crawler-objectives)
- [Proof of Concept (PoC)](#proof-of-concept-poc)
- [How to Use](#how-to-use)
- [Ethical Considerations](#ethical-considerations)
- [Limitations and Future Work](#limitations-and-future-work)
- [References](#references)

---

## Introduction to CSRF

**Cross-Site Request Forgery (CSRF)** is an attack that exploits the trust a website has in the user's browser. If a user is authenticated, malicious sites can trick the browser into sending unwanted requests to a vulnerable web application, performing actions without the user's consent.

### Real-World Examples:
- Changing the user's email or password
- Making unwanted financial transactions
- Submitting or deleting data

---

## CSRF Protection Mechanisms

Modern web applications use several techniques to prevent CSRF attacks:

### 1. CSRF Tokens
- Each form includes a unique, session-bound token.
- The server verifies the token on submission.

### 2. SameSite Cookies
- Cookies can be restricted from being sent in cross-site requests using `SameSite` attributes.

### 3. Double-Submit Cookies
- A CSRF token is sent in both a cookie and a form field or header, and the values must match.

### 4. Header Validation
- Some applications validate the `Origin` or `Referer` header to ensure the request originated from a trusted source.

---

## Crawler Objectives

The goal of the crawler is to:

- Identify HTML forms on a target web page
- Detect whether a CSRF token is present in the form inputs
- Log all forms that lack visible CSRF protection mechanisms

The crawler can be useful for penetration testers and researchers trying to assess a web application’s defense posture against CSRF attacks.

---

## Proof of Concept (PoC)

The PoC simulates a CSRF attack using a crafted HTML form. This form sends an unauthorized request to a vulnerable web application endpoint when loaded in the user’s browser.

### Scenario Simulated:
- A malicious actor embeds this form on a phishing site.
- An authenticated user visits the page.
- The browser automatically submits the request, performing an unintended action on behalf of the user.

This highlights the importance of validating every state-changing request with a CSRF token on the server side.

---

## How to Use

1. Use the crawler (provided separately) to scan target web applications.
2. Review output logs for forms without CSRF tokens.
3. Modify the PoC HTML form to target a real vulnerable endpoint (such as from a test application like DVWA or bWAPP).
4. Open the PoC in a browser to simulate a CSRF attack.
5. Verify whether the action was completed without authentication confirmation.

---

## Ethical Considerations

- This project is intended for **educational and ethical security research** only.
- Always ensure you have **explicit permission** before scanning or testing any system.
- Do not use these tools on live systems without authorization.
- Follow responsible disclosure guidelines when reporting vulnerabilities.

---

## Limitations and Future Work

### Current Limitations:
- Static detection (does not account for dynamic CSRF tokens generated by JavaScript)
- No authentication support to access protected pages
- No request replay or fuzzing capability

### Future Improvements:
- Add support for login session handling
- Detect token headers like `X-CSRF-Token`
- Log results to a structured report (e.g., CSV or JSON)
- Auto-generate PoC based on identified forms

---

## References

- OWASP CSRF Guide: https://owasp.org/www-community/attacks/csrf
- PortSwigger Web Security Academy: https://portswigger.net/web-security/csrf
- Mozilla Developer Docs on SameSite: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie/SameSite

---

## Submission Instructions

1. Upload your work (crawler + PoC + this README) to a GitHub repository.
2. Share your repo in the Cyber-Security Discord channel using the following format:

